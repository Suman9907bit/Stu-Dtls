<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Student Portal</title>

<style>
body {font-family:Arial;background:#eef2f7;margin:0}
.header{background:#0b3c8a;color:white;padding:15px;text-align:center;font-size:22px}
.card{background:white;max-width:700px;margin:30px auto;padding:20px;border-radius:10px;box-shadow:0 5px 15px rgba(0,0,0,.15)}
input,button{width:100%;padding:12px;margin:10px 0;border-radius:6px;border:1px solid #ccc}
button{background:#0b3c8a;color:white;border:none;cursor:pointer}
.row{background:#f5f9ff;padding:10px;margin:6px 0;border-radius:6px}
.tabs{display:grid;grid-template-columns:repeat(4,1fr);gap:8px}
.tabBtn{background:#e4ecff;color:#0b3c8a}
.section{margin-top:15px;padding:15px;background:#f9fbff;border-radius:8px}
.hide{display:none}
</style>
</head>

<body>

<div class="header">Student Portal</div>

<div class="card" id="loginBox">
<h3>Login</h3>
<input id="username" placeholder="Student ID">
<input id="password" type="password" placeholder="Password">
<button onclick="login()">Login</button>
<p id="msg" style="color:red;"></p>
</div>

<div class="card hide" id="dashboard">

<h3>Student Profile</h3>

<div class="row">Name: <span id="name"></span></div>
<div class="row">Roll: <span id="roll"></span></div>
<div class="row">Course: <span id="course"></span></div>
<div class="row">Mobile: <span id="mobile"></span></div>
<div class="row">Live Day: <span id="day"></span></div>
<div class="row">Course Amount: <span id="courseamount"></span></div>

<div class="tabs">
<button class="tabBtn" onclick="loadSection('fees')">Fees</button>
<button class="tabBtn" onclick="loadSection('certificate')">Certificate</button>
<button class="tabBtn" onclick="loadSection('present')">Present</button>
<button class="tabBtn" onclick="loadSection('course')">Course</button>
</div>

<div id="sectionData" class="section">Click tab to load</div>

<button onclick="logout()">Logout</button>
</div>

<script>

const URL = "https://script.google.com/macros/s/AKfycbyNkL2-s2w0SYv77TWUktItlnreJY3MN2NIa_azZvldn8J29u7uDWP-ds6gH5Ca7IPg/exec";

let currentUser="";

function safe(v){ return (!v) ? "—" : v; }

function liveDay(date){
 if(!date) return "—";
 return Math.floor((new Date()-new Date(date))/(1000*60*60*24));
}

async function login(){

 const f=new FormData();
 f.append("action","login");
 f.append("username",document.getElementById("username").value.trim());
 f.append("password",document.getElementById("password").value.trim());

 const r=await fetch(URL,{method:"POST",body:f});
 const d=await r.json();

 console.log("LOGIN DATA =",d);

 if(d.status==="success"){

  currentUser=document.getElementById("username").value.trim();

  document.getElementById("loginBox").classList.add("hide");
  document.getElementById("dashboard").classList.remove("hide");

  document.getElementById("name").innerText=safe(d.name);
  document.getElementById("roll").innerText=safe(d.roll);
  document.getElementById("mobile").innerText=safe(d.mobile);
  document.getElementById("course").innerText=safe(d.course);
  document.getElementById("courseamount").innerText=safe(d.courseamount);
  document.getElementById("day").innerText=liveDay(d.date);

 } else {
  document.getElementById("msg").innerText="Invalid ID or Password";
 }
}

async function loadSection(type){

 sectionData.innerText="Loading...";

 const f=new FormData();
 f.append("action","section");
 f.append("username",currentUser);
 f.append("type",type);

 const r=await fetch(URL,{method:"POST",body:f});
 const d=await r.json();

 if(!d.length){
  sectionData.innerText="No Data Found";
  return;
 }

 let html="";
 d.forEach(x=>{
  html+=`<div class="row">${x.join(", ")}</div>`;
 });

 sectionData.innerHTML=html;
}

function logout(){ location.reload(); }

</script>

</body>
</html>
