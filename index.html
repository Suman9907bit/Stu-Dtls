<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Student Portal</title>

<style>
/* Basic Reset */
*{box-sizing:border-box;margin:0;padding:0;font-family:Arial,sans-serif}

/* Body Background */
body{
  background: url('https://i.pinimg.com/736x/e2/b0/9a/e2b09ae3d7f223f4c4f1d882b29aadd4.jpg') no-repeat center center fixed;
  background-size: cover;
  min-height: 100vh;
  display: flex;
  justify-content: center;
  align-items: center;
  padding: 15px;
}

/* Overlay for better contrast */
body::before{
  content:"";
  position:absolute;
  top:0; left:0; right:0; bottom:0;
  background:rgba(0,0,0,0.4);
  z-index:0;
}

/* Card Styling */
.card{
  position: relative;
  z-index:1;
  background: rgba(255,255,255,0.95);
  max-width: 400px;
  width: 100%;
  padding: 30px 25px;
  border-radius: 12px;
  box-shadow: 0 8px 25px rgba(0,0,0,0.2);
}

/* Header */
.header{
  text-align: center;
  font-size: 26px;
  margin-bottom: 20px;
  color: #0b3c8a;
  font-weight: bold;
}

/* Inputs & Buttons */
input, button{
  width: 100%;
  padding: 12px 15px;
  margin: 10px 0;
  border-radius: 8px;
  border: 1px solid #ccc;
  font-size: 16px;
}

input:focus{
  outline:none;
  border-color:#0b3c8a;
  box-shadow: 0 0 5px rgba(11,60,138,0.5);
}

button{
  background:#0b3c8a;
  color:white;
  border:none;
  cursor:pointer;
  transition: 0.3s;
}

button:hover{
  background:#0952a0;
}

/* Row styling */
.row{
  background:#f5f9ff;
  padding:10px;
  margin:6px 0;
  border-radius:6px;
}

/* Tabs */
.tabs{
  display:grid;
  grid-template-columns:repeat(4,1fr);
  gap:8px;
  margin-top: 15px;
}

.tabBtn{
  background:#e4ecff;
  color:#0b3c8a;
  border:none;
  padding:10px;
  border-radius:6px;
  cursor:pointer;
  transition:0.3s;
}

.tabBtn:hover{
  background:#d0e0ff;
}

/* Section */
.section{
  margin-top:15px;
  padding:15px;
  background:#f9fbff;
  border-radius:8px;
  min-height: 80px;
}

/* Hide Class */
.hide{display:none}

/* Responsive */
@media(max-width:500px){
  .tabs{grid-template-columns:repeat(2,1fr);}
}
</style>
</head>

<body>

<div class="card" id="loginBox">
  <div class="header">Student Login</div>
  <input id="username" placeholder="Student ID">
  <input id="password" type="password" placeholder="Password">
  <button onclick="login()">Login</button>
  <p id="msg" style="color:red;text-align:center;"></p>
</div>

<div class="card hide" id="dashboard">
  <div class="header">Student Profile</div>

  <div class="row">Name: <span id="name"></span></div>
  <div class="row">Roll: <span id="roll"></span></div>
  <div class="row">Course: <span id="course"></span></div>
  <div class="row">Mobile: <span id="mobile"></span></div>
  <div class="row">Live Day: <span id="day"></span></div>
  <div class="row">Course Amount: <span id="courseamount"></span></div>

  <div class="tabs">
    <button class="tabBtn" onclick="loadSection('fees')">Fees</button>
    <button class="tabBtn" onclick="loadSection('certificate')">Certificate</button>
    <button class="tabBtn" onclick="loadSection('present')">Present</button>
    <button class="tabBtn" onclick="loadSection('course')">Course</button>
  </div>

  <div id="sectionData" class="section">Click tab to load</div>

  <button onclick="logout()">Logout</button>
</div>

<script>
const URL = "https://script.google.com/macros/s/AKfycbyNkL2-s2w0SYv77TWUktItlnreJY3MN2NIa_azZvldn8J29u7uDWP-ds6gH5Ca7IPg/exec";

let currentUser="";

function safe(v){ return (!v) ? "—" : v; }

function liveDay(date){
 if(!date) return "—";
 return Math.floor((new Date()-new Date(date))/(1000*60*60*24));
}

async function login(){
 const f=new FormData();
 f.append("action","login");
 f.append("username",document.getElementById("username").value.trim());
 f.append("password",document.getElementById("password").value.trim());

 const r=await fetch(URL,{method:"POST",body:f});
 const d=await r.json();

 console.log("LOGIN DATA =",d);

 if(d.status==="success"){
  currentUser=document.getElementById("username").value.trim();

  document.getElementById("loginBox").classList.add("hide");
  document.getElementById("dashboard").classList.remove("hide");

  document.getElementById("name").innerText=safe(d.name);
  document.getElementById("roll").innerText=safe(d.roll);
  document.getElementById("mobile").innerText=safe(d.mobile);
  document.getElementById("course").innerText=safe(d.course);
  document.getElementById("courseamount").innerText=safe(d.courseamount);
  document.getElementById("day").innerText=liveDay(d.date);

 } else {
  document.getElementById("msg").innerText="Invalid ID or Password";
 }
}

async function loadSection(type){
 sectionData.innerHTML="Loading...";

 const f=new FormData();
 f.append("action","section");
 f.append("username",currentUser);
 f.append("type",type);

 const r=await fetch(URL,{method:"POST",body:f});
 const d=await r.json();

 if(!d.length){
  sectionData.innerHTML="No Data Found";
  return;
 }

 // Table Start
 let html=`
 <div style="overflow-x:auto;">
 <table style="width:100%;border-collapse:collapse;">
   <thead>
     <tr>
 `;

 // Header row (first row as heading)
 d[0].forEach(head=>{
   html+=`<th style="border:1px solid #ccc;padding:8px;background:#e4ecff;color:#0b3c8a;">${head}</th>`;
 });

 html+=`</tr></thead><tbody>`;

 // Data rows (skip first row if it's header in sheet)
 for(let i=1;i<d.length;i++){
   html+="<tr>";
   d[i].forEach(cell=>{
     html+=`<td style="border:1px solid #ccc;padding:8px;text-align:center;">${cell}</td>`;
   });
   html+="</tr>";
 }

 html+=`</tbody></table></div>`;

 sectionData.innerHTML=html;
}
function logout(){ location.reload(); }
</script>

</body>
</html>
